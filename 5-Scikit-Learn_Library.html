
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5 Biblioteca Scikit-Learn &#8212; Ciência dos Dados</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '5-Scikit-Learn_Library';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6 Regressão Linear" href="6-Regression_Analysis.html" />
    <link rel="prev" title="4 Biblioteca Pandas" href="4-Pandas_Library.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0-Index.html">
  
  
  
  
  
  
    <p class="title logo__title">Ciência dos Dados</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0-Index.html">
                    Introdução à ciência dos dados
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1-Introduction_to_Jupyter_Platform.html">1 - IPython</a></li>

<li class="toctree-l1"><a class="reference internal" href="2.1-Data_Structures.html"><!--NAVIGATION--></a></li>

<li class="toctree-l1"><a class="reference internal" href="2.2-Logical_Operations.html">2 Conceitos básicos de programação</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.3-Control_Structures.html">2 Conceitos básicos de programação</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.4-Functions.html">2 Conceitos básicos de programação</a></li>





<li class="toctree-l1"><a class="reference internal" href="2-Introduction_to_python_programming_language.html">2 - Introdução à linguagem de programação Python</a></li>


<li class="toctree-l1"><a class="reference internal" href="3-NumPy_Library.html">3  Biblioteca NumPy</a></li>




<li class="toctree-l1"><a class="reference internal" href="4-Pandas_Library.html">4  Biblioteca Pandas</a></li>






<li class="toctree-l1 current active"><a class="current reference internal" href="#">5  Biblioteca Scikit-Learn</a></li>






<li class="toctree-l1"><a class="reference internal" href="6-Regression_Analysis.html">6  Regressão Linear</a></li>








<li class="toctree-l1"><a class="reference internal" href="7-Classification_Analysis.html">7 Análise de Classificação</a></li>





<li class="toctree-l1"><a class="reference internal" href="8-Cluster_Analysis.html">8  Análise de Agrupamento</a></li>




<li class="toctree-l1"><a class="reference internal" href="short-tutorial.html">Conceitos básicos de Python e da biblioteca Pandas</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F5-Scikit-Learn_Library.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/5-Scikit-Learn_Library.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>5  Biblioteca Scikit-Learn</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">5  Biblioteca Scikit-Learn</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introducao-a-biblioteca-scikit-learn">1 - Introdução à biblioteca Scikit-Learn</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aprendizado-de-maquinas-em-scikit-learn">1.1 - Aprendizado de máquinas em Scikit-Learn</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dados-em-scikit-learn">2 - Dados em Scikit-Learn</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conceitos-da-api-de-scikit-learn">3 - Conceitos da API de Scikit-Learn</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ilustracao-da-api-analise-de-regressao">4 - Ilustração da API - Análise de Regressão</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ilustracao-da-api-analise-de-classificacao">5 - Ilustração da API - Análise de Classificação</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#referencias">6 - Referências</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#voltar-ao-topo"><span class="xref myst">Voltar ao topo</span></a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <!--NAVIGATION-->
<p>&lt; <a class="reference internal" href="4-Pandas_Library.html"><span class="std std-doc">Pandas Library</span></a> | <a class="reference internal" href="0-Index.html"><span class="std std-doc">Contents</span></a> | <a class="reference internal" href="6-Regression_Analysis.html"><span class="std std-doc">Regression_Analysis</span></a>  &gt;</p>
<section class="tex2jax_ignore mathjax_ignore" id="biblioteca-scikit-learn">
<h1>5  Biblioteca Scikit-Learn<a class="headerlink" href="#biblioteca-scikit-learn" title="Link to this heading">#</a></h1>
<p><a class="reference external" href="http://colab.research.google.com/github/computational-chemical-biology/DataScience/blob/master/5-Scikit-Learn_Library.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p><a id="top"></a> <br>
<strong>Conteúdo do <em>Notebook</em></strong></p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#1"><span class="xref myst">Introdução à biblioteca Scikit-Learn</span></a></p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#11"><span class="xref myst">Aprendizado de máquinas em Scikit-Learn</span></a></p></li>
</ol>
</li>
<li><p><a class="reference internal" href="#2"><span class="xref myst">Dados em Scikit-Learn</span></a></p></li>
<li><p><a class="reference internal" href="#3"><span class="xref myst">Conceitos da API de Scikit-Learn</span></a></p></li>
<li><p><a class="reference internal" href="#4"><span class="xref myst">Ilustração da API - Análise de Regressão</span></a></p></li>
<li><p><a class="reference internal" href="#5"><span class="xref myst">Ilustração da API - Análise de Classificação</span></a></p></li>
<li><p><a class="reference internal" href="#6"><span class="xref myst">Referências</span></a></p></li>
</ol>
<p><a id="1"></a> <br></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introducao-a-biblioteca-scikit-learn">
<h1>1 - Introdução à biblioteca Scikit-Learn<a class="headerlink" href="#introducao-a-biblioteca-scikit-learn" title="Link to this heading">#</a></h1>
<p>A biblioteca <a class="reference external" href="http://scikit-learn.org">Scikit-Learn</a> fornece versões eficientes de um grande número de algoritmos comumente utilizados no aprendizado de máquinas. A ampla adoção da biblioteca se deve muito a simplicidade e eficiência da sua Interface de Programação de Aplicação (do inglês API - <em>Application Programming Interface</em>), ou seja, o conjunto de rotinas e padrões estabelecidos pela biblioteca para acessar suas funcionalidades. Os padrões uniformes permitem que o aprendizado de diferentes modelos seja facilitado. Esta seção irá introduzir algumas funcionalidades da biblioteca Scikit-Learn associadas ao aprendizado de máquinas <cite data-cite="236589/TU28EEPW"></cite>.</p>
<p><a id="11"></a> <br></p>
<section id="aprendizado-de-maquinas-em-scikit-learn">
<h2>1.1 - Aprendizado de máquinas em Scikit-Learn<a class="headerlink" href="#aprendizado-de-maquinas-em-scikit-learn" title="Link to this heading">#</a></h2>
<p>Aprendizado de máquinas utiliza algoritmos (de forma simplificada, um conjunto de instruções para resolver um problema), para criar modelos capazes de utilizar as caracteristicas da estrutura e distribuição dos dados, desta forma, obtendo informações úteis a respeito de fenômenos sobre os quais se quer aprender mais <cite data-cite="236589/HI9L49ZT"></cite>.</p>
<p>Durante o curso vimos diferentes maneiras de categorizar as formas de aprender a partir de um conjunto de dados. Nas próximas seções discutiremos <strong>Regressão</strong>, <strong>Classificação</strong> e <strong>Agrupamento</strong>. Utilizaremos estas categorias para motivar os conceitos de aprendizado de máquinas.</p>
<p>Técnicas de classificação são geralmente utilizadas para diferenciar classes discretas. A figura abaixo utiliza as bibliotecas matplotlib e seaborn para visualizar as distribuições, em uma e duas dimensões, de caracteristicas de plantas (variáveis quantitativas largura e comprimentos de pétalas e sépalas) de três espécies (<em>setosa</em>, <em>versicolor</em> e <em>virginica</em>). Observando a figura é possível perceber diferenças entre as espécies baseadas em suas características, o que indica a possibilidade da criação de um algoritmo para utilizar essas características para distinguir as espécies. Esse é um exemplo de problema em que as técnicas de classificação podem ser utilizadas.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># %matplotlib inline faz com que as saídas dos plots sejam direcionadas para o notebook</span>
<span class="o">%</span><span class="k">matplotlib</span> inline 
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span><span class="p">;</span> <span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;iris&#39;</span><span class="p">)</span> <span class="c1"># carrega o conjunto de dados</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mf">1.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/mnt/home/rsilva/Documents/miniconda3/envs/datascience/lib/python3.12/site-packages/seaborn/axisgrid.py:2100: UserWarning: The `size` parameter has been renamed to `height`; please update your code.
  warnings.warn(msg, UserWarning)
</pre></div>
</div>
<img alt="_images/dcb28f4854361de0292d587e30d6a796301ebf7013bfedb3a16831e9f46b1304.png" src="_images/dcb28f4854361de0292d587e30d6a796301ebf7013bfedb3a16831e9f46b1304.png" />
</div>
</div>
<p>Técnicas de regressão são utilizadas para aprender relações quantitativas entre variáveis contínuas. A figura abaixo utiliza a simulação de variáveis quantitativas utilizando a biblioteca NumPy. Novamente, a observação de uma correlação positiva entre duas variáveis indica a possibilidade de aprender sobre uma variável (*y), conhecendo outra (*x).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6e88fb2c5615c470fb96dbc57c79302e549b2a8a41a7bbf12f83422acbde4e06.png" src="_images/6e88fb2c5615c470fb96dbc57c79302e549b2a8a41a7bbf12f83422acbde4e06.png" />
</div>
</div>
<p><a id="2"></a> <br></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dados-em-scikit-learn">
<h1>2 - Dados em Scikit-Learn<a class="headerlink" href="#dados-em-scikit-learn" title="Link to this heading">#</a></h1>
<p>Os algoritmos de aprendizado de máquinas disponíveis na biblioteca Scikit-Learn utilizam dados armazenados em <em>arrays</em> em duas dimensões. Os arrays podem ser do tipo NumPy, ou matrizes scipy.sparce. Os <em>arrays</em> são organizados com amostras nas linhas (<em>n_samples</em>) e características das amostras nas colunas (<em>n_features</em>). Como exemplos de amostras e características temos:</p>
<p>Amostra: Também descritos como itens ou objetos são as variáveis sobre as quais se quer aprender, realizando classificação ou regressão. Como exemplos amostras podem ser documentos, imagens, som, vídeo, ou qualquer objeto que possa ser descrito com características quantitativas.</p>
<p>Características: O número de caraterísticas ou traços distintos entre as amostras podem ser utilizados para descrever as amostras de forma quantitativa. As características são geralmente variáveis contínuas, mas podem também ser binárias ou discretas.</p>
<p>Vejamos como inspecionar o número de amostras e características no conjunto de dados visto acima:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(150, 5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_amostras</span><span class="p">,</span> <span class="n">n_caract</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Número de amostras:&#39;</span><span class="p">,</span> <span class="n">n_amostras</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Número de características:&#39;</span><span class="p">,</span> <span class="n">n_caract</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Número de amostras: 150 
Número de características: 5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># inspecionar o cabeçalho dos dados</span>
<span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># contar as classes em que se dividem as amostras </span>
<span class="n">iris</span><span class="p">[</span><span class="s1">&#39;species&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>species
setosa        50
versicolor    50
virginica     50
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plotar duas características diferenciando as amostras por cores</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">],</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;sepal_width&#39;</span><span class="p">],</span> 
            <span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span>
            <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span><span class="o">+</span>
            <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x789200284fb0&gt;
</pre></div>
</div>
<img alt="_images/4792990f9a1330a0e39f4ba6657094b79d7000bfc09167f56e913165b4b927be.png" src="_images/4792990f9a1330a0e39f4ba6657094b79d7000bfc09167f56e913165b4b927be.png" />
</div>
</div>
<p><a id="3"></a> <br></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="conceitos-da-api-de-scikit-learn">
<h1>3 - Conceitos da API de Scikit-Learn<a class="headerlink" href="#conceitos-da-api-de-scikit-learn" title="Link to this heading">#</a></h1>
<p>Os algoritmos em Scikit-Learn são acessados através da interface ‘’Estimator’’. Por exemplo, para utilizar os algoritmos de regressão linear fazemos:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>
</div>
</div>
</div>
<p>Os parâmetros de um objeto da classe “Estimator” podem ser alterados assim que um objeto da classe é criado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Criação de um objeto e modificação do parâmetro &#39;normalize&#39;</span>
<span class="n">modelo</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">modelo</span><span class="o">.</span><span class="n">normalize</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># Criação de um objeto e modificação do parâmetro &#39;normalize&#39;</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">modelo</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="nb">print</span><span class="p">(</span><span class="n">modelo</span><span class="o">.</span><span class="n">normalize</span><span class="p">)</span>

<span class="ne">TypeError</span>: LinearRegression.__init__() got an unexpected keyword argument &#39;normalize&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">modelo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=True)
</pre></div>
</div>
</div>
</div>
<p>Para aplicar o modelo a um conjunto de dados devemos lembrar do formato dos dados de entrada vistos acima</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="c1"># criação de uma matriz 3 (objetos) x 1 (característica)</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0],
       [1],
       [2]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=True)
</pre></div>
</div>
</div>
</div>
<p>Para obter os parâmetros estimados pelo modelo (veremos mais detalhes adiante), podemos acessar os atributos terminados <strong>_</strong> . Lembre-se de acessar as possibilidades fazendo <strong>model.</strong>’TAB’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1.])
</pre></div>
</div>
</div>
</div>
<p>Como descrito anteriormente, a padronização da API de Scikit-Learn permite a utilização dos mesmos métodos para diferentes algoritmos, a seguir uma breve descrição de alguns médotos diponíveis:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Onde</p></th>
<th class="head"><p>Nome do método</p></th>
<th class="head"><p>Descrição</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Todos estimadores</p></td>
<td><p><em>modelo.fit()</em></p></td>
<td><p>Para aprendizadado supervisonado utiliza dois parâmetros de entrada, dados (X) e rótulos (y). Para aprendizado não-supervisionado apenas X</p></td>
</tr>
<tr class="row-odd"><td><p>Em estimadores para aprendizado supervisionado</p></td>
<td><p><em>modelo.predict()</em></p></td>
<td><p>Dado um modelo treinado e um novo conjunto de carcterísticas X_novo, prediz o rótulo da amostra</p></td>
</tr>
<tr class="row-even"><td><p>Alguns estimadores para aprendizado supervisionado</p></td>
<td><p><em>modelo.predict_proba()</em></p></td>
<td><p>Probabilidade da nova observação pertencer a cada classe (dada pelos rótulos y)</p></td>
</tr>
<tr class="row-odd"><td><p>Em estimadores para aprendizado supervisionado</p></td>
<td><p><em>modelo.score()</em></p></td>
<td><p><em>Scores</em> assumem valores entre 0 e 1, maior o <em>score</em> maior o ajuste (<em>fit</em>) do modelo</p></td>
</tr>
<tr class="row-even"><td><p>Em estimadores para aprendizado não-supervisionado</p></td>
<td><p><em>modelo.transform()</em></p></td>
<td><p>Dado um modelo treinado e um novo conjunto de carcterísticas X_novo, executa transformações, como projeções</p></td>
</tr>
<tr class="row-odd"><td><p>Alguns estimadores para aprendizado não-supervisionado</p></td>
<td><p><em>modelo.fit_transform()</em></p></td>
<td><p>Realizam <em>fit</em> e <em>transform</em> simultaneamente</p></td>
</tr>
</tbody>
</table>
</div>
<p><a id="4"></a> <br></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ilustracao-da-api-analise-de-regressao">
<h1>4 - Ilustração da API - Análise de Regressão<a class="headerlink" href="#ilustracao-da-api-analise-de-regressao" title="Link to this heading">#</a></h1>
<p>Utilizaremos o conjunto de dados disponível na biblioteca Scikit-Learn com os preços de casas na cidade americana de Boston. Estes dados são constituídos de 13 características do mercado imobiliário (X) e com a mediana dos preços (y). Tentaremos responder a pergunta: É possível predizer o preço de um imóvel baseando-nos em suas características?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<span class="n">dados</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dados</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dados</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(506, 13)
(506,)
</pre></div>
</div>
</div>
</div>
<p>Como conjunto de dados presente na biblioteca para o aprendizado também podemos obter uma descrição detalhada:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">dados</span><span class="o">.</span><span class="n">DESCR</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>.. _boston_dataset:

Boston house prices dataset
---------------------------

**Data Set Characteristics:**  

    :Number of Instances: 506 

    :Number of Attributes: 13 numeric/categorical predictive. Median Value (attribute 14) is usually the target.

    :Attribute Information (in order):
        - CRIM     per capita crime rate by town
        - ZN       proportion of residential land zoned for lots over 25,000 sq.ft.
        - INDUS    proportion of non-retail business acres per town
        - CHAS     Charles River dummy variable (= 1 if tract bounds river; 0 otherwise)
        - NOX      nitric oxides concentration (parts per 10 million)
        - RM       average number of rooms per dwelling
        - AGE      proportion of owner-occupied units built prior to 1940
        - DIS      weighted distances to five Boston employment centres
        - RAD      index of accessibility to radial highways
        - TAX      full-value property-tax rate per $10,000
        - PTRATIO  pupil-teacher ratio by town
        - B        1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town
        - LSTAT    % lower status of the population
        - MEDV     Median value of owner-occupied homes in $1000&#39;s

    :Missing Attribute Values: None

    :Creator: Harrison, D. and Rubinfeld, D.L.

This is a copy of UCI ML housing dataset.
https://archive.ics.uci.edu/ml/machine-learning-databases/housing/


This dataset was taken from the StatLib library which is maintained at Carnegie Mellon University.

The Boston house-price data of Harrison, D. and Rubinfeld, D.L. &#39;Hedonic
prices and the demand for clean air&#39;, J. Environ. Economics &amp; Management,
vol.5, 81-102, 1978.   Used in Belsley, Kuh &amp; Welsch, &#39;Regression diagnostics
...&#39;, Wiley, 1980.   N.B. Various transformations are used in the table on
pages 244-261 of the latter.

The Boston house-price data has been used in many machine learning papers that address regression
problems.   
     
.. topic:: References

   - Belsley, Kuh &amp; Welsch, &#39;Regression diagnostics: Identifying Influential Data and Sources of Collinearity&#39;, Wiley, 1980. 244-261.
   - Quinlan,R. (1993). Combining Instance-Based and Model-Based Learning. In Proceedings on the Tenth International Conference of Machine Learning, 236-243, University of Massachusetts, Amherst. Morgan Kaufmann.
</pre></div>
</div>
</div>
</div>
<p>Como exemplo básico de Regressão linear (tópico da próxima seção) utilizaremos a função <code class="docutils literal notranslate"><span class="pre">LinearRegression</span></code> para executar o método dos mínimos quadrados.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> <span class="c1"># funções para dividir os dados</span>

<span class="n">X_treinamento</span><span class="p">,</span> <span class="n">X_teste</span><span class="p">,</span> <span class="n">y_treinamento</span><span class="p">,</span> <span class="n">y_teste</span> <span class="o">=</span> \
<span class="n">train_test_split</span><span class="p">(</span><span class="n">dados</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dados</span><span class="o">.</span><span class="n">target</span><span class="p">)</span> <span class="c1"># divide os dados em conjuntos de treinamento e teste</span>
                                           <span class="c1"># veremos mais detalhes adiante                           </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span> <span class="c1"># Cria um objeto do regressor</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_treinamento</span><span class="p">,</span> <span class="n">y_treinamento</span><span class="p">)</span> <span class="c1"># executa o treinamento com método fit</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predito</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_teste</span><span class="p">)</span> <span class="c1"># realiza a predição de um conjunto externo ao treinamento</span>
<span class="n">esperado</span> <span class="o">=</span> <span class="n">y_teste</span>
<span class="c1"># raiz do valor quadrático médio (do inglês - Root Mean Square)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RMS: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">predito</span> <span class="o">-</span> <span class="n">esperado</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RMS: 4.8341086307749395
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">esperado</span><span class="p">,</span> <span class="n">predito</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Preço Predito ($1000s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Preço Verdadeiro ($1000s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.text.Text at 0x7f2048ecc940&gt;
</pre></div>
</div>
<img alt="_images/191283fd711020a1946ce2aa98165d90e27f2ab183a8f8ed02309c4a2c7fdac5.png" src="_images/191283fd711020a1946ce2aa98165d90e27f2ab183a8f8ed02309c4a2c7fdac5.png" />
</div>
</div>
<p><a id="5"></a> <br></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="ilustracao-da-api-analise-de-classificacao">
<h1>5 - Ilustração da API - Análise de Classificação<a class="headerlink" href="#ilustracao-da-api-analise-de-classificacao" title="Link to this heading">#</a></h1>
<p>Nesta seção utilizaremos o conjunto de dados disponível na biblioteca Scikit-Learn de escrita de dígitos para ilustrar a API para classificação. Tentaremos responder a pergunta: É possível classificar a imagem de um dígito com o valor real do mesmo?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>
<span class="n">digitos</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Criar figuras criando sub-plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># plotar os dígitos: cada um como uma imagem de 8x8 píxeis</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">digitos</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/a5ca9e1449d6d9583bb5b803e4a174caca9ee60de5180335a3285ddda4bd476b.png" src="_images/a5ca9e1449d6d9583bb5b803e4a174caca9ee60de5180335a3285ddda4bd476b.png" />
</div>
</div>
<p>Como exemplo básico de classicação (tópico das próximas seções) utilizaremos a função <code class="docutils literal notranslate"><span class="pre">RandomForestClassifier</span></code> para executar o método de Florestas Aleatórias (do inglês <em>Random Forest</em>) <cite data-cite="236589/HI9L49ZT"></cite>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">X_treinamento</span><span class="p">,</span> <span class="n">X_teste</span><span class="p">,</span> <span class="n">y_treinamento</span><span class="p">,</span> <span class="n">y_teste</span> <span class="o">=</span> \
<span class="n">train_test_split</span><span class="p">(</span><span class="n">digitos</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">digitos</span><span class="o">.</span><span class="n">target</span><span class="p">)</span> <span class="c1"># divide os dados em conjuntos de treinamento e teste</span>
                                               <span class="c1"># veremos mais detalhes adiante                           </span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>  <span class="c1"># criar objeto com métodos para o classificador</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_treinamento</span><span class="p">,</span> <span class="n">y_treinamento</span><span class="p">)</span> <span class="c1"># treinar o modelo</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/rsilva/miniconda3/lib/python3.7/site-packages/sklearn/ensemble/forest.py:245: FutureWarning: The default value of n_estimators will change from 10 in version 0.20 to 100 in 0.22.
  &quot;10 in version 0.20 to 100 in 0.22.&quot;, FutureWarning)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
                       max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=10,
                       n_jobs=None, oob_score=False, random_state=None,
                       verbose=0, warm_start=False)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use the model to predict the labels of the test data</span>
<span class="n">predito</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_teste</span><span class="p">)</span>
<span class="n">esperado</span> <span class="o">=</span> <span class="n">y_teste</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rótulos Preditos:&#39;</span><span class="p">,</span> <span class="n">predito</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rótulos Esperados:&#39;</span><span class="p">,</span> <span class="n">esperado</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rótulos Preditos: [2 3 1 0 1 1 2 0 1 3 9 9 2 1 3 4 3 6 4 7 3 1 7 5 0 0 8 3 4 7 7 4 7 5 9 6 4
 3 4 2 9 0 2 5 6 2 4 0 8 5 0 7 1 1 9 8 5 8 6 7 8 8 4 3 9 8 1 2 4 2 0 7 1 8
 6 1 1 7 6 9 1 5 3 2 8 1 5 3 0 5 7 9 0 9 8 0 3 4 2 9 6 6 7 8 2 0 4 7 2 1 7
 0 6 2 7 2 2 4 8 9 9 0 9 4 0 0 3 8 8 6 7 8 4 3 0 1 7 5 1 3 7 9 7 3 5 6 1 5
 2 1 7 6 7 0 9 8 1 4 8 9 5 9 1 9 8 6 2 3 9 4 8 6 6 3 0 9 3 4 6 2 4 3 0 7 7
 0 8 2 5 3 1 9 7 3 6 4 6 7 8 6 1 6 8 4 2 5 6 1 1 7 0 0 0 9 4 5 0 7 3 5 8 8
 8 4 2 8 4 9 1 8 2 2 6 9 9 4 4 6 3 9 1 4 3 4 9 5 8 3 2 9 2 1 2 7 0 2 4 2 6
 1 2 9 2 6 5 3 9 3 1 0 4 2 7 0 7 3 1 9 7 7 2 8 5 5 1 1 3 9 3 9 2 0 8 2 5 0
 5 9 1 8 9 8 2 6 3 3 4 5 2 0 8 1 1 0 9 4 6 2 7 4 8 3 3 0 8 8 4 4 1 8 7 7 1
 6 1 1 5 1 3 9 6 2 8 3 4 6 9 4 5 6 6 8 0 9 7 3 4 7 6 0 2 3 9 5 7 2 1 6 0 9
 7 4 8 6 0 6 6 0 3 8 6 4 7 9 4 4 4 1 3 3 9 9 6 3 4 7 6 2 1 7 0 7 6 1 8 9 8
 4 7 6 7 0 9 4 8 6 6 2 4 0 7 0 4 6 4 0 6 2 9 2 5 4 1 4 2 2 5 0 4 3 3 8 7 0
 1 3 5 6 5 4]
Rótulos Esperados: [2 3 1 0 1 1 2 0 9 3 9 9 2 1 3 4 3 6 4 7 3 1 7 5 0 0 8 3 4 7 7 4 7 5 9 6 4
 9 4 2 9 0 2 5 6 2 4 0 8 5 0 4 1 1 9 8 5 8 6 7 2 8 4 3 9 8 1 2 4 2 0 7 1 8
 6 1 1 7 6 9 1 5 3 2 8 1 5 3 0 5 7 9 0 9 8 0 3 4 2 9 6 6 7 8 2 0 4 7 2 1 7
 0 6 2 7 3 2 4 2 9 9 0 9 4 0 0 3 8 8 6 7 8 4 3 0 1 7 5 1 3 7 9 7 3 5 6 1 5
 2 1 7 6 7 0 9 8 1 4 8 9 5 9 1 9 8 6 2 3 9 4 8 6 6 3 0 9 3 4 6 2 4 3 0 7 7
 0 8 2 5 3 1 9 7 3 6 4 6 7 8 6 1 6 8 4 2 5 6 1 1 7 0 0 8 9 4 5 0 7 3 9 8 8
 8 4 2 2 4 9 1 8 2 2 6 9 9 4 4 6 3 9 1 4 3 5 9 5 8 3 2 9 2 1 2 7 0 3 4 2 6
 1 3 9 2 6 5 3 9 3 1 0 4 2 7 0 7 3 1 9 7 7 2 8 5 5 1 1 3 9 3 9 2 0 8 2 5 0
 5 9 1 8 9 8 2 6 3 3 4 5 2 0 8 1 9 0 9 4 6 2 7 4 8 3 3 0 8 8 4 4 1 8 7 7 1
 6 1 1 5 1 3 9 6 2 8 3 4 6 9 4 5 6 6 8 0 9 7 3 4 7 6 0 2 3 9 5 7 2 1 6 0 9
 7 4 7 6 0 6 6 0 3 8 6 4 7 9 4 4 4 1 3 3 9 9 6 3 4 7 6 2 1 7 0 7 6 1 8 9 8
 4 7 6 7 0 9 4 3 6 6 2 4 0 7 0 4 6 4 0 5 2 9 2 5 4 1 4 2 2 5 0 4 3 3 8 7 6
 1 3 5 6 5 4]
</pre></div>
</div>
</div>
</div>
<p><a id="6"></a> <br></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="referencias">
<h1>6 - Referências<a class="headerlink" href="#referencias" title="Link to this heading">#</a></h1>
<div class="cite2c-biblio"></div><section id="voltar-ao-topo">
<h2><a class="reference internal" href="#top"><span class="xref myst">Voltar ao topo</span></a><a class="headerlink" href="#voltar-ao-topo" title="Link to this heading">#</a></h2>
<!--NAVIGATION-->
<p>&lt; <a class="reference internal" href="4-Pandas_Library.html"><span class="std std-doc">Pandas Library</span></a> | <a class="reference internal" href="0-Index.html"><span class="std std-doc">Contents</span></a> | <a class="reference internal" href="6-Regression_Analysis.html"><span class="std std-doc">Regression_Analysis</span></a>  &gt;</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4-Pandas_Library.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">4  Biblioteca Pandas</p>
      </div>
    </a>
    <a class="right-next"
       href="6-Regression_Analysis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">6  Regressão Linear</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">5  Biblioteca Scikit-Learn</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introducao-a-biblioteca-scikit-learn">1 - Introdução à biblioteca Scikit-Learn</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aprendizado-de-maquinas-em-scikit-learn">1.1 - Aprendizado de máquinas em Scikit-Learn</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#dados-em-scikit-learn">2 - Dados em Scikit-Learn</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#conceitos-da-api-de-scikit-learn">3 - Conceitos da API de Scikit-Learn</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ilustracao-da-api-analise-de-regressao">4 - Ilustração da API - Análise de Regressão</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#ilustracao-da-api-analise-de-classificacao">5 - Ilustração da API - Análise de Classificação</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#referencias">6 - Referências</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#voltar-ao-topo"><span class="xref myst">Voltar ao topo</span></a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ricardo R. da Silva
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>